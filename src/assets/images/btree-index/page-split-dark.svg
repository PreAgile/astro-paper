<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 520" style="font-family: 'Segoe UI', system-ui, sans-serif;">
  <defs>
    <marker id="arrow-dark" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9ca3af"/>
    </marker>
    <filter id="shadow-d" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.4"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="520" fill="#1f2937"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="600" fill="#f3f4f6">Page Split 발생 과정</text>

  <!-- BEFORE Section -->
  <text x="200" y="70" text-anchor="middle" font-size="15" font-weight="600" fill="#f87171">BEFORE (Page Full)</text>

  <!-- Full Page -->
  <g filter="url(#shadow-d)">
    <rect x="50" y="90" width="300" height="180" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="2"/>
    <text x="200" y="115" text-anchor="middle" font-size="13" font-weight="500" fill="#fca5a5">Page (16KB) - 93% Full</text>

    <!-- Data blocks -->
    <rect x="65" y="130" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="92" y="152" text-anchor="middle" font-size="11" fill="#fecaca">PK: 1</text>

    <rect x="125" y="130" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="152" y="152" text-anchor="middle" font-size="11" fill="#fecaca">PK: 2</text>

    <rect x="185" y="130" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="212" y="152" text-anchor="middle" font-size="11" fill="#fecaca">PK: 3</text>

    <rect x="245" y="130" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="272" y="152" text-anchor="middle" font-size="11" fill="#fecaca">PK: 5</text>

    <rect x="65" y="175" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="92" y="197" text-anchor="middle" font-size="11" fill="#fecaca">PK: 6</text>

    <rect x="125" y="175" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="152" y="197" text-anchor="middle" font-size="11" fill="#fecaca">PK: 7</text>

    <rect x="185" y="175" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="212" y="197" text-anchor="middle" font-size="11" fill="#fecaca">PK: 8</text>

    <rect x="245" y="175" width="55" height="35" rx="4" fill="#7f1d1d" stroke="#ef4444"/>
    <text x="272" y="197" text-anchor="middle" font-size="11" fill="#fecaca">...</text>

    <!-- Free space indicator -->
    <rect x="65" y="220" width="270" height="25" rx="4" fill="#450a0a" stroke="#7f1d1d" stroke-dasharray="4,2"/>
    <text x="200" y="237" text-anchor="middle" font-size="10" fill="#fca5a5">Free Space: 7% (여유 없음)</text>
  </g>

  <!-- Insert arrow -->
  <g>
    <rect x="130" y="280" width="140" height="35" rx="6" fill="#78350f" stroke="#fbbf24" stroke-width="2"/>
    <text x="200" y="302" text-anchor="middle" font-size="12" font-weight="500" fill="#fcd34d">INSERT PK: 4</text>
  </g>

  <!-- Arrow pointing to problem -->
  <path d="M 200 315 L 200 330 L 400 330 L 400 90" stroke="#fbbf24" stroke-width="2" fill="none" marker-end="url(#arrow-dark)" stroke-dasharray="6,3"/>
  <text x="300" y="350" text-anchor="middle" font-size="11" fill="#fcd34d">공간 부족! Split 발생</text>

  <!-- AFTER Section -->
  <text x="600" y="70" text-anchor="middle" font-size="15" font-weight="600" fill="#4ade80">AFTER (Page Split)</text>

  <!-- Page 1 -->
  <g filter="url(#shadow-d)">
    <rect x="450" y="90" width="150" height="140" rx="8" fill="#14532d" stroke="#4ade80" stroke-width="2"/>
    <text x="525" y="115" text-anchor="middle" font-size="12" font-weight="500" fill="#86efac">Page 1 (50%)</text>

    <rect x="465" y="130" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="492" y="150" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 1</text>

    <rect x="525" y="130" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="552" y="150" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 2</text>

    <rect x="465" y="165" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="492" y="185" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 3</text>

    <rect x="525" y="165" width="55" height="30" rx="4" fill="#22c55e" stroke="#4ade80" stroke-width="2"/>
    <text x="552" y="185" text-anchor="middle" font-size="10" font-weight="600" fill="#14532d">PK: 4</text>

    <text x="552" y="220" text-anchor="middle" font-size="9" fill="#4ade80">← NEW</text>
  </g>

  <!-- Page 2 -->
  <g filter="url(#shadow-d)">
    <rect x="620" y="90" width="150" height="140" rx="8" fill="#14532d" stroke="#4ade80" stroke-width="2"/>
    <text x="695" y="115" text-anchor="middle" font-size="12" font-weight="500" fill="#86efac">Page 2 (50%)</text>

    <rect x="635" y="130" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="662" y="150" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 5</text>

    <rect x="700" y="130" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="727" y="150" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 6</text>

    <rect x="635" y="165" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="662" y="185" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 7</text>

    <rect x="700" y="165" width="55" height="30" rx="4" fill="#166534" stroke="#4ade80"/>
    <text x="727" y="185" text-anchor="middle" font-size="10" fill="#bbf7d0">PK: 8</text>
  </g>

  <!-- Split Cost Box -->
  <g filter="url(#shadow-d)">
    <rect x="50" y="380" width="320" height="120" rx="8" fill="#78350f" stroke="#fbbf24" stroke-width="2"/>
    <text x="210" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#fcd34d">Page Split 비용</text>
    <text x="70" y="430" font-size="11" fill="#fef3c7">1. 새 Page 할당 (디스크 I/O)</text>
    <text x="70" y="450" font-size="11" fill="#fef3c7">2. 데이터 50% 이동 (메모리 복사)</text>
    <text x="70" y="470" font-size="11" fill="#fef3c7">3. B+-tree 구조 갱신 (포인터 수정)</text>
    <text x="70" y="490" font-size="11" fill="#fef3c7">4. Redo Log 기록 (WAL)</text>
  </g>

  <!-- Result Box -->
  <g filter="url(#shadow-d)">
    <rect x="430" y="380" width="340" height="120" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="2"/>
    <text x="600" y="405" text-anchor="middle" font-size="13" font-weight="600" fill="#fca5a5">결과: 공간 낭비 + 성능 저하</text>
    <text x="450" y="430" font-size="11" fill="#fecaca">• 두 Page 모두 50%만 사용 (낭비 50%)</text>
    <text x="450" y="450" font-size="11" fill="#fecaca">• 물리적 순서 ≠ 논리적 순서</text>
    <text x="450" y="470" font-size="11" fill="#fecaca">• Sequential Read → Random Read로 전환</text>
    <text x="450" y="490" font-size="11" fill="#fecaca">• Buffer Pool 효율 저하</text>
  </g>
</svg>