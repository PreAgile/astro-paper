<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" style="font-family: 'Segoe UI', system-ui, sans-serif;">
  <defs>
    <marker id="arr-d" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#eaedf3"/>
    </marker>
    <filter id="sh-d" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="500" fill="#212737"/>

  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-size="18" font-weight="600" fill="#eaedf3">장애 발생 Timeline</text>

  <!-- Time axis -->
  <line x1="80" y1="70" x2="850" y2="70" stroke="#eaedf3" stroke-width="2" marker-end="url(#arr-d)"/>
  <text x="870" y="75" font-size="11" fill="#adb5bd">시간</text>

  <!-- Time markers -->
  <line x1="120" y1="65" x2="120" y2="75" stroke="#eaedf3" stroke-width="2"/>
  <text x="120" y="58" text-anchor="middle" font-size="10" fill="#adb5bd">13:25</text>

  <line x1="320" y1="65" x2="320" y2="75" stroke="#eaedf3" stroke-width="2"/>
  <text x="320" y="58" text-anchor="middle" font-size="10" fill="#adb5bd">13:28</text>

  <line x1="520" y1="65" x2="520" y2="75" stroke="#eaedf3" stroke-width="2"/>
  <text x="520" y="58" text-anchor="middle" font-size="10" fill="#adb5bd">13:30</text>

  <line x1="750" y1="65" x2="750" y2="75" stroke="#eaedf3" stroke-width="2"/>
  <text x="750" y="58" text-anchor="middle" font-size="10" fill="#adb5bd">13:35</text>

  <!-- T1: MQ Worker Transaction -->
  <g filter="url(#sh-d)">
    <rect x="120" y="90" width="630" height="50" rx="8" fill="#1e3a5f" stroke="#4dabf7" stroke-width="2"/>
    <text x="135" y="112" font-size="11" font-weight="600" fill="#4dabf7">T1: 메시지 큐 워커</text>
    <text x="135" y="128" font-size="10" fill="#74c0fc">BEGIN; SELECT * FROM reviews ... (MDL_SHARED_WRITE 보유)</text>
    <text x="730" y="120" text-anchor="end" font-size="9" fill="#adb5bd">외부 API 호출 + 비즈니스 로직</text>
  </g>

  <!-- T2: ALTER TABLE -->
  <g filter="url(#sh-d)">
    <rect x="320" y="155" width="430" height="50" rx="8" fill="#5c4813" stroke="#ffd43b" stroke-width="2"/>
    <text x="335" y="177" font-size="11" font-weight="600" fill="#ffd43b">T2: DBA - ALTER TABLE</text>
    <text x="335" y="193" font-size="10" fill="#ffe066">MDL_EXCLUSIVE 요청 → 대기 시작 ⏳</text>
  </g>

  <!-- Warning marker -->
  <rect x="310" y="175" width="20" height="20" rx="3" fill="#ff6b6b"/>
  <text x="320" y="190" text-anchor="middle" font-size="12" fill="#ffffff">!</text>

  <!-- T3: Backend APIs blocked -->
  <g filter="url(#sh-d)">
    <rect x="340" y="220" width="410" height="80" rx="8" fill="#4a1e1e" stroke="#ff6b6b" stroke-width="2"/>
    <text x="355" y="245" font-size="11" font-weight="600" fill="#ff6b6b">T3~T4: 백엔드 API 요청들</text>
    <text x="355" y="263" font-size="10" fill="#ffa8a8">SELECT, INSERT, UPDATE → 모두 MDL 대기 상태!</text>
    <text x="355" y="283" font-size="10" fill="#ffc9c9">Convoy Effect 발생 - 수십 개 세션이 큐에 쌓임</text>
  </g>

  <!-- DB Load spike -->
  <g filter="url(#sh-d)">
    <rect x="520" y="315" width="180" height="60" rx="8" fill="#4a1e1e" stroke="#ffa8a8" stroke-width="2"/>
    <text x="610" y="340" text-anchor="middle" font-size="12" font-weight="700" fill="#ff6b6b">DB Load 급증!</text>
    <text x="610" y="360" text-anchor="middle" font-size="14" font-weight="600" fill="#ffa8a8">0.1 → 18.65</text>
  </g>

  <!-- T5: Recovery -->
  <g filter="url(#sh-d)">
    <rect x="750" y="90" width="120" height="210" rx="8" fill="#14532d" stroke="#51cf66" stroke-width="2"/>
    <text x="810" y="115" text-anchor="middle" font-size="11" font-weight="600" fill="#51cf66">T5: 정상화</text>
    <text x="760" y="140" font-size="9" fill="#69db7c">1. MQ 워커 COMMIT</text>
    <text x="760" y="160" font-size="9" fill="#69db7c">2. MDL 해제</text>
    <text x="760" y="180" font-size="9" fill="#69db7c">3. ALTER 실행 (1.2초)</text>
    <text x="760" y="200" font-size="9" fill="#69db7c">4. 대기 세션 해제</text>
    <text x="810" y="240" text-anchor="middle" font-size="12" font-weight="600" fill="#51cf66">DB Load</text>
    <text x="810" y="260" text-anchor="middle" font-size="14" font-weight="700" fill="#51cf66">18.65 → 0.21</text>
    <text x="810" y="285" text-anchor="middle" font-size="10" fill="#69db7c">✓ 정상</text>
  </g>

  <!-- Key insight box -->
  <rect x="80" y="400" width="740" height="85" rx="10" fill="#5c4813" stroke="#ffd43b" stroke-width="2"/>
  <text x="100" y="425" font-size="13" font-weight="600" fill="#ffd43b">💡 핵심 포인트</text>
  <text x="100" y="450" font-size="12" fill="#ffe066">• ALTER TABLE 자체는 1.2초면 끝나는 작업이었음</text>
  <text x="100" y="470" font-size="12" fill="#ffe066">• 문제의 본질: 선행 트랜잭션이 7분간 MDL을 보유하고 있었음</text>
</svg>